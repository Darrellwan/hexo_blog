<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="提供平方公尺轉坪數的線上換算工具，簡單易用，一次最多可換算十組資料，方便您快速計算房屋、土地等面積。此外，本工具支援記憶功能，可儲存您常用的換算資料，下次使用更加便利。">
<title>SmartPing 坪數計算器</title>
<link rel="apple-touch-icon" sizes="180x180" href="https://www.darrelltw.com/smart_ping_asset/smart_ping_apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.darrelltw.com/smart_ping_asset/smart_ping_favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.darrelltw.com/smart_ping_asset/smart_ping_favicon-16x16.png">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.darrelltw.com/smart_ping.html">
<meta property="og:title" content="SmartPing 坪數計算器">
<meta property="og:description" content="提供平方公尺轉坪數的線上換算工具，簡單易用，一次最多可換算十組資料，方便您快速計算房屋、土地等面積。此外，本工具支援記憶功能，可儲存您常用的換算資料，下次使用更加便利。">
<meta property="og:image" content="https://www.darrelltw.com/smart_ping_icon.jpg">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://www.darrelltw.com/smart_ping.html">
<meta property="twitter:title" content="SmartPing 坪數計算器">
<meta property="twitter:description" content="提供平方公尺轉坪數的線上換算工具，簡單易用，一次最多可換算十組資料，方便您快速計算房屋、土地等面積。此外，本工具支援記憶功能，可儲存您常用的換算資料，下次使用更加便利。">
<meta property="twitter:image" content="https://www.darrelltw.com/smart_ping_icon.jpg">

<style>
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

  body {
    font-family: 'Arial', sans-serif;
    background-color: #394867;
    color: #ffffff;
    margin: 0;
    padding: 20px;
  }
  .container {
    max-width: 600px;
    margin: auto;
    background: #4E5D73;
    padding: 20px;
    border-radius: 10px;
  }
  h1 {
    text-align: center;
    color: #E6E6E6;
  }
  .input-group {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
  }
  .input-field {
    flex: 1;
    padding: 10px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    color: #333;
  }
  .btn {
    display: inline-block;
    padding: 10px 20px;
    background-color: #3d4a61;
    color: white;
    text-align: center;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: transform 0.3s ease;
  }
  .btn:hover {
    transform: translateY(-2px);
  }
  .clear-btn {
    background-color: #7A8BA8;
    margin-top: 10px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }
  table, th, td {
    border: 1px solid #DDE1E9;
  }
  th, td {
    text-align: left;
    padding: 8px;
  }
  tr:nth-child(even) {
    background-color: #5F6E86;
  }
  .delete-record-btn {
    background-color: #C44D58;
    color: white;
    padding: 8px 15px;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }

    .delete-record-btn:hover {
        background-color: #D35D6E;
        transform: translateY(-1px);
    }

    .delete-record-btn:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(196, 77, 88, 0.2);
    }

  .input-field {
    box-sizing: border-box;
  }
  .input-square {
    background: #FFF;
    border: 1px solid #999;
    padding: 10px;
    border-radius: 10px;
    margin-right: 10px;
  }
  .input-square:last-child {
    margin-right: 0;
  }
  .input-square input {
    border: none;
    width: 100%;
    font-size: 1em;
  }
  .input-square input:focus {
    outline: none;
  }
</style>
</head>
<body>
<div class="container">
  <h1>坪數計算器</h1>
  <div class="input-group">
    <div class="input-square">
      <input type="number" id="length" class="input-field" pattern="[0-9]*" inputmode="numeric" placeholder="長 (cm)">
    </div>
    <div class="input-square">
      <input type="number" id="width" class="input-field" pattern="[0-9]*" inputmode="numeric" placeholder="寬 (cm)">
    </div>
    <div class="input-square">
      <input type="number" id="area" class="input-field" pattern="[0-9]*" inputmode="numeric" placeholder="m²">
    </div>
  </div>
  <button class="btn" onclick="calculate()">計算坪數</button>
  <button id="clearHistory" class="btn clear-btn">清空記錄</button>

  <table id="history">
    <colgroup>
        <col style="width: 10%;">
        <col style="width: 10%;">
        <col style="width: 20%;">
        <col style="width: 20%;">
        <col style="width: 10%;">
    </colgroup>
    <thead>
      <tr>
        <th>長 (cm)</th>
        <th>寬 (cm)</th>
        <th>m²</th>
        <th>坪</th>
        <th></th>
      </tr>
    </tbody>
    </thead>
    <tbody id="historyBody"></tbody>
  </table>
</div>

<script>
        const lengthInput = document.getElementById("length");
        const widthInput = document.getElementById("width");
        const areaInput = document.getElementById("area");
        const historyTableBody = document.getElementById("historyBody");
        const clearHistoryButton = document.getElementById("clearHistory");
  
        let history = JSON.parse(localStorage.getItem("history")) || [];

        function trackDt(event, additionalData){
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({event: event, ...additionalData})
        }

        function generateId() {
            const chars = "abcdefghijklmnopqrstuvwxyz0123456789";
            let id = "";
            for (let i = 0; i < 16; i++) {
                id += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return id;
        }

        function calculatePing(e) {
          let length = parseFloat(lengthInput.value);
          let width = parseFloat(widthInput.value);
          let area = parseFloat(areaInput.value);
          if (e.target.getAttribute("id") == "length" || e.target.getAttribute("id") == "width") {
            if (!length || !width) {
              return false;
            }
            let m_length = length / 100;
            let m_width = width / 100;
  
            if (m_length > 0 && m_width > 0) {
              area = m_length * m_width;
              areaInput.value = area.toFixed(2);
            }
          } else if (e.target.getAttribute("id") == "area") {
              lengthInput.value = '';
              widthInput.value = '';
              length = '';
              width = '';
          }
          let ping;
  
          if (area > 0) {
            ping = area / 3.3058;
            addRecord(length, width, area, ping);
          }
        }
  
        function addRecord(length, width, area, ping) {
          const randomId = generateId();
          const record = { length, width, area, ping, randomId };
          history.unshift(record);
          history = history.slice(0, 10);
          localStorage.setItem("history", JSON.stringify(history));
          trackDt("calculate_ping", {ping: ping, length: length, area: area, randomId: randomId})
          renderHistory();
        }
  
        function renderHistory() {
            historyTableBody.innerHTML = "";
            history.forEach((record) => {
            const row = historyTableBody.insertRow();
            row.innerHTML = `
                <td>${record.length || "-"} cm</td>
                <td>${record.width || "-"} cm</td>
                <td>${record.area.toFixed(2)} ㎡</td>
                <td>${record.ping.toFixed(2)} 坪</td>
                <td><button class="delete-record-btn" onclick="deleteRecord(this)">X</button></td>
            `;
            row.setAttribute("data-id", record.randomId);
          });
        }
  
        function clearHistory() {
            localStorage.removeItem("history");
            history = [];
            renderHistory();
        }

        function deleteRecord(btn) {
            let row = btn.parentNode.parentNode;
            let rowId = row.getAttribute("data-id");
            console.log({rowId: rowId});
            let dataArray = JSON.parse(localStorage.getItem('history'));
            let objectIndex = dataArray.findIndex(obj => obj.randomId === rowId);
            if (objectIndex !== -1) {
                dataArray.splice(objectIndex, 1);
                localStorage.setItem('history', JSON.stringify(dataArray));
            }
            trackDt("delete_record", {randomId: rowId})
            row.parentNode.removeChild(row);
        }
  
        lengthInput.addEventListener("change", calculatePing);
        widthInput.addEventListener("change", calculatePing);
        areaInput.addEventListener("change", calculatePing);
        clearHistoryButton.addEventListener("click", clearHistory);
  
        renderHistory();
</script>
</body>
</html>
